@page "/gifttimothythree"
@inject IToastService ToastService

<div style="position: relative;">
     @if (isLocked)
   
    }
    <h1 class="header">Present ett Timothy <br> Första gåtan</h1>

    <p class="bread">
        I ett litet paket, gömd i hemmets vrå, <br>
        vilar en vän som vaknar när morgonen står på. <br>
        Med ett tryck och ett sus, blir världen mer klar, <br>
        en morgonritual, förvandlad till magi, var da. <br><br>

        I sin metalliska dräkt, står den tyst och stolt, <br>
        väntar på att uppfylla sitt givna löfte. <br>
        Med en doft som sprider sig, varm och djupt omfamnande, <br>
        ger den styrka till dagens alla möten och löften..
    </p>

    <input class="input" type="text" @bind="userGuess" />
    <button class="button" @onclick="CheckAnswer">Gissa</button>

   
</div>

@code {
    private string? userGuess;
    private const string Tip = "två ord, första ordet börjar på K****, andra ordet börjar på K******* | Sista Försöket";
    private const string CorrectAnswer = "Kaffe kappslar";

    private int wrongGuessCount = 0;
    private bool isLocked = false;
 private bool showModal = false;
    void CheckAnswer()
    {
        if (string.IsNullOrEmpty(userGuess))
        {
            ShowToast(ToastType.Error, new ToastMessage { Title = "Error", Content = "Du måste skriva något Timse!" });
        }
        else if (userGuess.Equals(CorrectAnswer, StringComparison.OrdinalIgnoreCase))
        {
                ShowToast(ToastType.Success, new ToastMessage { Title = "Grattis!", Content = "Du vann en frukost på valfrit ställe (Värde 20kr)" });
            }
            else
            {
        wrongGuessCount++; // Increment the count at the beginning of the else block
        if (wrongGuessCount == 1)
        {
            ShowToast(ToastType.Info, new ToastMessage { Title = "Fel svar!", Content = "Försök igen!" });
        }
        else if (wrongGuessCount == 2)
        {
            ShowToast(ToastType.Info, new ToastMessage { Title = "Fel svar!", Content = Tip });
        }
        else if (wrongGuessCount == 3)
        {
            ShowToast(ToastType.Error, new ToastMessage { Title = "Fel svar!", Content = "Du har inga fler försök kvar! Bättre lycka nästa år" });
            isLocked = true;
            ShowModal();
        }
        }

    public void ShowToast(ToastType type, ToastMessage message)
    {
        ToastService.ShowToast<MyToastComponent>(new ToastParameters()
            .Add(nameof(MyToastComponent.Message), message)
            .Add(nameof(MyToastComponent.ToastType), type));
    }
}
